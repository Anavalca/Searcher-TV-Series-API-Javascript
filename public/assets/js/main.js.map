{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst SearchInput = document.querySelector('#search_input');\nconst searchButton = document.querySelector('#search_button');\nlet ulSeries = document.querySelector('#series_list');\nlet ulFav = document.querySelector('#favourites_list');\n\nlet series = [];\nlet favourites = [];\nreadLocalStorage();\n\n//LLAMAR A LA API PARA REALIZAR BÃšSQUEDA\nfunction loadSeries(){\n  fetch(`http://api.tvmaze.com/search/shows?q=${SearchInput.value}`)\n    .then(response => response.json())\n    .then(data => {\n      series = data;\n      showSeriesSearch(series);\n    });\n}\n\n//PINTAR LOS RESULTADOS DE LA BUSQUEDA\nfunction showSeriesSearch(arr){\n  ulSeries.innerHTML = '';\n  for(let item of arr){\n    let isFavourite = false;\n    let liObject = document.createElement('li');\n    liObject.setAttribute('id','ele_'+item.show.id);\n    liObject.classList.add('listSeries');\n\n    let imgObject = document.createElement('img');\n    if(item.show.image === null){\n      imgObject.setAttribute('src','https://via.placeholder.com/210x295/ffffff/666666/?text=TV');\n    }\n    else{\n      imgObject.setAttribute('src',item.show.image.medium);\n    }\n\n    let pObject = document.createElement('p');\n    pObject.classList.add('main-title');\n    pObject.appendChild(document.createTextNode(item.show.name));\n\n    //COMPROBAR SI EN LA BUSQUEDA DE LA API HAY ALGUN FAVORITO Y ANYADIRLE LA CLASE\n    let startIcon;\n    for(let favourite of favourites){\n      if(item.show.id === parseInt(favourite.id)){\n        liObject.classList.add('favouritesMainStyle');\n        startIcon = document.createElement('i');\n        startIcon.classList.add('icon_fav');\n        startIcon.classList.add('fas');\n        startIcon.classList.add('fa-star');\n        isFavourite = true;\n      }\n    }\n    \n    //CREAR ESTRUCTURA DE CADA OBJETO DEL MAIN\n    liObject.appendChild(imgObject);\n    liObject.appendChild(pObject);\n    if(isFavourite){\n      liObject.appendChild(startIcon);\n    }\n    ulSeries.appendChild(liObject);\n\n  }\n  addClickListeners();\n\n}\n\n//ANYADIR EVENTO A LOS LI (CADA SERIE DEL MAIN)\nfunction addClickListeners(){\n  const liList = document.querySelectorAll('#series_list li');\n  for(let li of liList){\n    li.addEventListener('click',saveFavourites);\n  }\n}\n\n//ACCION GUARDAR FAVORITOS\nfunction saveFavourites(event){\n  \n  let idFound = false;\n  \n  //ITERAMOS TODOS LOS ELEMENTOS DE FAVOURITES PARA SABER SI EL NUEVO ELEMENTO YA ESTABA METIDO\n  for (let favourite of favourites){\n    let elementId = event.currentTarget.id.substr(4);\n    if(favourite.id === elementId){\n      idFound = true;\n      break;\n    }\n  }\n  //SI NO ESTABA METIDO LO METEMOS\n  if(idFound === false){\n    setLocalStorage(event.currentTarget);\n    renderFavourite(event.currentTarget);\n    event.currentTarget.classList.add('favouritesMainStyle'); //COLOREAR FAVORITOS DEL LISTADO DEL MAIN\n    let startIcon = document.createElement('i');\n    startIcon.classList.add('icon_fav');\n    startIcon.classList.add('fas');\n    startIcon.classList.add('fa-star');\n    event.currentTarget.appendChild(startIcon);\n  } else {\n    removeFavouriteFromUl(event);\n  }\n}\n\n//PINTAR FAVORITOS EN EL ASIDE\nfunction renderFavourite(favouriteElement) {\n  let favCopy = favouriteElement.cloneNode(true);\n  favCopy.id = favCopy.id.replace('ele', 'fav');\n  let buttomItem = document.createElement('button');\n  buttomItem.type = 'button';\n  buttomItem.classList.add('deleteButton');\n  buttomItem.addEventListener('click',removeFavouriteFromButton);\n  buttomItem.appendChild(document.createTextNode('x'));\n  favCopy.appendChild(buttomItem);\n  ulFav.appendChild(favCopy);\n}\n\n//GUARDAR FAVORITOS EN LOCALSTORAGE\nfunction setLocalStorage(currentFav) {\n  let newFavourite = new Object();\n  newFavourite.id = currentFav.id.substr(4);\n  newFavourite.imgSrc = currentFav.childNodes[0].src;\n  newFavourite.name = currentFav.childNodes[1].textContent;\n  \n  favourites.push(newFavourite);\n  localStorage.setItem('seriesFavInfo', JSON.stringify(favourites));\n}\n\n//LEER LOS DATOS DE LOCAL STORAGE\nfunction readLocalStorage() {\n  let localInfo = JSON.parse(localStorage.getItem('seriesFavInfo'));\n  if (localInfo !== null) {\n    for (let objetSerie of localInfo) {\n      favourites.push(objetSerie);\n      renderFavouritesOfLocalStorage(objetSerie);\n    }\n  }\n}\n\n//PINTAR DATOS DEL LOCAL STORAGE\nfunction renderFavouritesOfLocalStorage(objectSerie) {\n  let liObject = document.createElement('li');\n  liObject.setAttribute('id', 'fav_' + objectSerie.id);\n  liObject.classList.add('listSeries');\n\n  let imgObject = document.createElement('img');\n  imgObject.setAttribute('src', objectSerie.imgSrc);\n\n  let pObject = document.createElement('p');\n  pObject.classList.add('main-title');\n  pObject.appendChild(document.createTextNode(objectSerie.name));\n\n  let buttomItem = document.createElement('button');\n  buttomItem.type = 'button';\n  buttomItem.classList.add('deleteButton');\n  buttomItem.appendChild(document.createTextNode('x'));\n  buttomItem.addEventListener('click',removeFavouriteFromButton);\n\n  //CREAR ESTRUCTURA DEL FAVORITO\n  liObject.appendChild(imgObject);\n  liObject.appendChild(pObject);\n  liObject.appendChild(buttomItem);\n  ulFav.appendChild(liObject);\n}\n\nfunction removeFavouriteFromId(id){\n  let index = 0;\n  for (let favourite of favourites){\n    if(favourite.id === id){\n      favourites.splice(index, 1);\n      localStorage.setItem('seriesFavInfo', JSON.stringify(favourites));\n      break;\n    }\n    index++;\n  }\n\n  //ELIMINAR DEL DOM EL ELEMENTO DE FAVORITOS\n  let elementToRemove = document.querySelector('#fav_'+id);\n  elementToRemove.remove();\n  //QUITAR ESTILOS FAVORITOS DEL LISTADO DEL MAIN\n  let elementToRestore = document.querySelector('#ele_'+id);\n  elementToRestore.classList.remove('favouritesMainStyle');\n  elementToRestore.lastChild.remove();\n\n}\n\nfunction removeFavouriteFromButton(event){\n  let removeId = event.currentTarget.parentElement.id;\n  removeId = removeId.substr(4);\n  removeFavouriteFromId(removeId);\n}\n\nfunction removeFavouriteFromUl(event){\n  let removeId = event.currentTarget.id;\n  removeId = removeId.substr(4);\n  removeFavouriteFromId(removeId);\n}\n\nsearchButton.addEventListener('click', loadSeries);\n"]}