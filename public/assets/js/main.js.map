{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst searchInput = document.querySelector('#search_input');\nconst searchButton = document.querySelector('#search_button');\nlet ulTvSeries = document.querySelector('#series_list');\nlet ulFav = document.querySelector('#favourites_list');\nlet webLogo = document.querySelector('#title_container');\nlet gifCoverPage = document.querySelector('.gif_container');\nlet favouritesIcon = document.querySelector('#icon_fav');\n\nlet tvSeries = [];\nlet favourites = [];\n\n//AL CARGAR AL PÁGINA PINTO LA CABECERA DE LA WEB Y LEO LOS DATOS DEL LOCAL STORAGE\nappearCoverPage();\nreadLocalStorage();\n\n//LLAMAR A LA API PARA REALIZAR BÚSQUEDA\nfunction loadSeries(){\n  fetch(`http://api.tvmaze.com/search/shows?q=${searchInput.value}`)\n    .then(response => response.json())\n    .then(data => {\n      tvSeries = data;\n      showSeriesSearch(tvSeries);\n      if(tvSeries.length == 0){\n        let pObject = document.createElement('p');\n        pObject.classList.add('alert');\n        pObject.appendChild(document.createTextNode('No hay elementos para esa búsqueda'));\n        ulTvSeries.appendChild(pObject);\n      }\n    });\n}\n\n//PINTAR LOS RESULTADOS DE LA BUSQUEDA EN EL MAIN\nfunction showSeriesSearch(arrTvSeries){\n  removeChildren(gifCoverPage);\n  removeChildren(ulTvSeries);\n  for(let item of arrTvSeries){\n    let isFavourite = false;\n    let liObject = document.createElement('li');\n    liObject.setAttribute('id','ele_'+item.show.id);\n    liObject.classList.add('listSeries');\n\n    let imgObject = document.createElement('img');\n    if(item.show.image === null){\n      imgObject.setAttribute('src','https://via.placeholder.com/210x295/ffffff/666666/?text=TV');\n    }\n    else{\n      imgObject.setAttribute('src',item.show.image.medium);\n    }\n\n    let pObject = document.createElement('p');\n    pObject.classList.add('main-title');\n    pObject.appendChild(document.createTextNode(item.show.name));\n\n   \n    //COMPROBAR SI EN LA BUSQUEDA DE LA API HAY ALGUN FAVORITO, ANYADIRLE LA CLASE Y CREAR EL ICONO DE FAVORITO\n    let startIcon;\n    for(let favourite of favourites){ \n      if(item.show.id === parseInt(favourite.id)){\n        liObject.classList.add('favouritesMainStyle');\n        startIcon = document.createElement('i');\n        startIcon.classList.add('icon_fav');\n        startIcon.classList.add('fas');\n        startIcon.classList.add('fa-star');\n        isFavourite = true;\n      }\n    }\n    \n    //CREAR ESTRUCTURA DE CADA OBJETO DEL MAIN\n    liObject.appendChild(imgObject);\n    liObject.appendChild(pObject);\n    if(isFavourite){ // INCRUSTAR EL ICONO DE FAVORITO DETRÁS DE LOS ELEMENTOS CORRESPONDIENTES PARA QUE APAREZCA EL ULTIMO\n      liObject.appendChild(startIcon);\n    }\n    ulTvSeries.appendChild(liObject);\n\n  }\n  addClickListeners();\n}\n\n//ANYADIR EVENTO A LOS LI (CADA SERIE DEL MAIN)\nfunction addClickListeners(){\n  const liList = document.querySelectorAll('#series_list li');\n  for(let li of liList){\n    li.addEventListener('click',saveFavourites);\n  }\n}\n\n//ACCION GUARDAR FAVORITOS\nfunction saveFavourites(event){\n  let idFound = false;\n  \n  //ITERAMOS TODOS LOS ELEMENTOS DE FAVOURITES PARA SABER SI EL NUEVO ELEMENTO YA ESTABA METIDO\n  for (let favourite of favourites){\n    let elementId = event.currentTarget.id.substr(4); //ELIMINAMOS ELE_ DEL ID PARA COMPARARLO\n    if(favourite.id === elementId){\n      idFound = true;\n      break; //SI ENCUENTRO MI ELEMENTO NO TENGO QUE SEGUIR ITERANDO\n    }\n  }\n  //SI NO ESTABA METIDO LO METEMOS\n  if(idFound === false){\n    setLocalStorage(event.currentTarget);\n    renderFavourite(event.currentTarget);\n    //COLOREAR FAVORITOS DEL LISTADO DEL MAIN Y ANYADIR ICONO FAV\n    event.currentTarget.classList.add('favouritesMainStyle'); \n    let startIcon = document.createElement('i');\n    startIcon.classList.add('icon_fav');\n    startIcon.classList.add('fas');\n    startIcon.classList.add('fa-star');\n    event.currentTarget.appendChild(startIcon);\n  } else {\n    removeFavouriteFromUl(event);\n  }\n}\n\n//PINTAR FAVORITOS EN EL ASIDE\nfunction renderFavourite(favouriteElement) {\n  let favCopy = favouriteElement.cloneNode(true); //ME CLONO EL LI DEL MAIN\n  favCopy.id = favCopy.id.replace('ele', 'fav'); //REMPLAZO LA CLASE PORQUE CLONO EL ELEMENTO DEL UL A FAVORITOS\n  let buttomItem = document.createElement('button');\n  buttomItem.type = 'button';\n  buttomItem.classList.add('deleteButton');\n  buttomItem.addEventListener('click',removeFavouriteFromButton);\n  buttomItem.appendChild(document.createTextNode('x'));\n  favCopy.appendChild(buttomItem);\n  ulFav.appendChild(favCopy);\n  changeStarFavoutitesIcon();\n}\n\n//GUARDAR FAVORITOS EN LOCALSTORAGE\nfunction setLocalStorage(currentFav) {\n  let newFavourite = new Object();\n  newFavourite.id = currentFav.id.substr(4);\n  newFavourite.imgSrc = currentFav.childNodes[0].src;\n  newFavourite.name = currentFav.childNodes[1].textContent;\n  \n  favourites.push(newFavourite);\n  localStorage.setItem('seriesFavInfo', JSON.stringify(favourites));\n}\n\n//LEER LOS DATOS DE LOCAL STORAGE\nfunction readLocalStorage() {\n  let localInfo = JSON.parse(localStorage.getItem('seriesFavInfo'));\n  if (localInfo !== null) {\n    for (let objetSerie of localInfo) {\n      favourites.push(objetSerie);\n      renderFavouritesOfLocalStorage(objetSerie);\n    }\n  }\n}\n\n//PINTAR DATOS DEL LOCAL STORAGE\nfunction renderFavouritesOfLocalStorage(objectSerie) {\n  let liObject = document.createElement('li');\n  liObject.setAttribute('id', 'fav_' + objectSerie.id);//ANYADO FAV_ PORQUE NO ME DEJA BUSCAR UN ID DE NUMEROS \n  liObject.classList.add('listSeries');\n\n  let imgObject = document.createElement('img');\n  imgObject.setAttribute('src', objectSerie.imgSrc);\n\n  let pObject = document.createElement('p');\n  pObject.classList.add('main-title');\n  pObject.appendChild(document.createTextNode(objectSerie.name));\n\n  let buttomItem = document.createElement('button');\n  buttomItem.type = 'button';\n  buttomItem.classList.add('deleteButton');\n  buttomItem.appendChild(document.createTextNode('x'));\n  buttomItem.addEventListener('click',removeFavouriteFromButton);\n\n  //CREAR ESTRUCTURA DEL FAVORITO\n  liObject.appendChild(imgObject);\n  liObject.appendChild(pObject);\n  liObject.appendChild(buttomItem);\n  ulFav.appendChild(liObject);\n\n  changeStarFavoutitesIcon();\n}\n\n// CUANDO RECIBO EL ID QUE VIENE DE CADA LADO ELIMINO ELEMENTOS DE FAVORITOS Y ESTILOS DE LOS li DEL MAIN\nfunction removeFavouriteFromId(id){\n  let index = 0;\n  for (let favourite of favourites){\n    if(favourite.id === id){\n      favourites.splice(index, 1);\n      localStorage.setItem('seriesFavInfo', JSON.stringify(favourites));\n      break;\n    }\n    index++;\n  }\n\n  //ELIMINAR DE SECCION FAVORITOS EL ELEMENTO\n  let elementToRemove = document.querySelector('#fav_'+id);\n  elementToRemove.remove();\n  //QUITAR ESTILOS DE FAVORITOS DEL LISTADO DEL MAIN\n  let elementToRestore = document.querySelector('#ele_'+id);\n  if(elementToRestore !== null){\n    elementToRestore.classList.remove('favouritesMainStyle');\n    elementToRestore.lastChild.remove(); //ELIMINO ICONO DE FAVORITO\n  }\n  changeStarFavoutitesIcon();\n}\n\n// BUSCO EL ID DEL ELEMENTO DE FAVORITOS DE LA **SECCIÓN** QUE QUIERO ELIMINAR\nfunction removeFavouriteFromButton(event){\n  let removeId = event.currentTarget.parentElement.id;\n  removeId = removeId.substr(4);\n  removeFavouriteFromId(removeId);\n}\n// BUSCO EL ID DEL ELEMENTO DE FAVORITOS DEL **MAIN** QUE QUIERO ELIMINAR\nfunction removeFavouriteFromUl(event){\n  let removeId = event.currentTarget.id;\n  removeId = removeId.substr(4);\n  removeFavouriteFromId(removeId);\n}\n\n//CUANDO HACEMOS CLICK EN EL LOGO DE LA WEB RESTAURAMOS EL MAIN Y EL INPUT SEARCH\nfunction restaureWeb(){\n  searchInput.value = '';\n  removeChildren(ulTvSeries);\n  appearCoverPage();\n}\n\n//PINTAR PORTADA DE LA WEB\nfunction appearCoverPage(){\n  let gifObject = document.createElement('img');\n  gifObject.setAttribute('src','./assets/images/tv.gif');\n  gifObject.setAttribute('id', 'gif_tv');\n  gifObject.setAttribute('title', 'Stay home');\n  gifObject.setAttribute('alt', 'gif tv message:stay home');\n  removeChildren(gifCoverPage);\n  gifCoverPage.appendChild(gifObject);\n}\n\n//FUNCIÓN PARA ELIMINAR LOS HIJOS DE UN ELEMENTO\nfunction removeChildren(object){\n  while (object.firstChild) {\n    object.removeChild(object.firstChild);\n  }\n}\n\n//BORRAR TODOS LOS FAVORITOS DESDE EL ICONO DE LA SECCIÓN\nfunction deteleAllFavouties(){\n \n  favourites = [];\n  localStorage.setItem('seriesFavInfo', JSON.stringify(favourites));\n\n  removeChildren(ulFav);\n\n  //ELIMINAR ESTILOS FAV MAIN\n  let liMainArr = document.querySelectorAll('.favouritesMainStyle');\n  for(let liMain of liMainArr){\n    liMain.classList.remove('favouritesMainStyle');\n    liMain.lastChild.remove(); //ELIMINO ICONO DE FAVORITO\n  }\n\n  changeStarFavoutitesIcon();\n}\n\n//FUNCION PARA REALIZAR BUSQUEDA CON EL ENTER\n\nfunction activeSearchWithEnter(event) {\n  if (event.keyCode === 13) {\n    loadSeries();\n  }\n}\n\nfunction changeStarFavoutitesIcon(){\n  if(ulFav.childNodes.length === 0){\n    favouritesIcon.classList.remove('fas');\n    favouritesIcon.classList.add('far');\n  } else {\n    favouritesIcon.classList.remove('far');\n    favouritesIcon.classList.add('fas');\n  }\n}\n\nfunction showAllFavourites(){\n  \n  for(let favourite of favourites){\n\n    console.log(favourite.name);\n  }\n \n}\n\nsearchButton.addEventListener('click', loadSeries);\nwebLogo.addEventListener('click', restaureWeb);\nfavouritesIcon.addEventListener('click',deteleAllFavouties);\ndocument.addEventListener('keydown', activeSearchWithEnter);\n"]}