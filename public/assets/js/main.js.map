{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst inputSearch = document.querySelector('#search_input');\nconst button = document.querySelector('#search_button');\nlet ulSeries = document.querySelector('#series_list');\nlet ulFav = document.querySelector('#favourites_list');\n\nlet series = [];\nlet favourites = [];\nreadLocalStorage();\n\n//LLAMAR A LA API PARA REALIZAR BÚSQUEDA\nfunction loadSeries(){\n  fetch(`http://api.tvmaze.com/search/shows?q=${inputSearch.value}`)\n    .then(response => response.json())\n    .then(data => {\n      series = data;\n      showSeriesSearch(series);\n    });\n}\n\n//PINTAR LOS RESULTADOS DE LA BUSQUEDA\nfunction showSeriesSearch(arr){\n  ulSeries.innerHTML = '';\n  for(let item of arr){\n    let liObject = document.createElement('li');\n    liObject.setAttribute('id',item.show.id);\n    liObject.classList.add('listSeries');\n\n    let imgObject = document.createElement('img');\n    if(item.show.image === null){\n      imgObject.setAttribute('src','https://via.placeholder.com/210x295/ffffff/666666/?text=TV');\n    }\n    else{\n      imgObject.setAttribute('src',item.show.image.medium);\n    }\n\n    let pObject = document.createElement('p');\n    pObject.classList.add('main-title');\n    pObject.appendChild(document.createTextNode(item.show.name));\n\n    //CREAR ESTRUCTURA DE CADA OBJETO DE FAVORITOS\n    liObject.appendChild(imgObject);\n    liObject.appendChild(pObject);\n    ulSeries.appendChild(liObject);\n  }\n\n  addClickListeners();\n}\n\n//PINTAR AÑADIR EVENTO A LOS LI (CADA SERIE MOSTRADA)\nfunction addClickListeners(){\n  const liList = document.querySelectorAll('#series_list li');\n  for(let li of liList){\n    li.addEventListener('click',saveFavourites);\n  }\n}\n\n//GUARDAR FAVORITOS\nfunction saveFavourites(event){\n  let idFound = false;\n\n  //iteramos todos los elementos de favourites para saber si el nuevo elemento esta ya metido\n  for (let favourite of favourites){\n    if(favourite.id === event.currentTarget.id){\n      idFound = true;\n      break;\n    }\n  }\n  \n  //si no estaba metido lo metemos\n  if(idFound === false){\n    setLocalStorage(event.currentTarget);\n    renderFavourite(event.currentTarget);\n  } else {\n    alert('Ya has añadido esta película a favoritos'); //buscar opción más elegante//\n  }\n\n}\n\n//PINTAR FAVORITOS EN EL ASIDE\nfunction renderFavourite(favouriteElement) {\n  let favCopy = favouriteElement.cloneNode(true);\n  let buttomItem = document.createElement('button');\n  buttomItem.type = 'button';\n  buttomItem.appendChild(document.createTextNode('Remove'));\n  favCopy.appendChild(buttomItem);\n  ulFav.appendChild(favCopy);\n\n}\n\n//GUARDAR FAVORITOS EN LOCALSTORAGE\nfunction setLocalStorage(currentFav) {\n  let newFavourite = new Object();\n  newFavourite.id = currentFav.id;\n  newFavourite.imgSrc = currentFav.childNodes[0].src;\n  newFavourite.name = currentFav.childNodes[1].textContent;\n  \n  favourites.push(newFavourite);\n  localStorage.setItem('seriesFavInfo', JSON.stringify(favourites));\n}\n\n//LEER LOS DATOS DE LOCAL STORAGE\nfunction readLocalStorage() {\n  let localInfo = JSON.parse(localStorage.getItem('seriesFavInfo'));\n  if (localInfo !== null) {\n    for (let objetSerie of localInfo) {\n      favourites.push(objetSerie);\n      renderFavouritesOfLocalStorage(objetSerie);\n    }\n  } else {\n    return localInfo = [];\n    //para que no de null devolvemos array vacío para llenarlo.\n  }\n}\n\n//PINTAR DATOS DE LOCAL STORAGE\nfunction renderFavouritesOfLocalStorage(objectSerie) {\n  let liObject = document.createElement('li');\n  liObject.setAttribute('id', objectSerie.id);\n  liObject.classList.add('listSeries');\n\n  let imgObject = document.createElement('img');\n  imgObject.setAttribute('src', objectSerie.imgSrc);\n\n  let pObject = document.createElement('p');\n  pObject.classList.add('main-title');\n  pObject.appendChild(document.createTextNode(objectSerie.name));\n\n  let buttomItem = document.createElement('button');\n  buttomItem.type = 'button';\n  buttomItem.appendChild(document.createTextNode('Remove'));\n\n  //CREAR ESTRUCTURA DE CADA OBJETO DE FAVORITOS\n  liObject.appendChild(imgObject);\n  liObject.appendChild(pObject);\n  liObject.appendChild(buttomItem);\n  ulFav.appendChild(liObject);\n}\n\nbutton.addEventListener('click', loadSeries);\n"]}